# CorineGen - AI 图像生成器 ✨

<div align="center">

基于 ComfyUI 的 React Web 应用程序，提供美观的可自定义主题界面，用于生成 AI 图像。

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![React](https://img.shields.io/badge/React-18-61dafb.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

</div>

---

## 🌟 核心功能

### 🎨 智能图像生成
- **多提示词管理**: 最多支持 10 个提示词同时管理
- **两种生成模式**: 批次模式（快速）和循环模式（可控）
- **智能队列系统**: 自动管理生成任务，可随时取消
- **实时进度反馈**: 精美的进度动画和百分比显示
- **一键高清化**: SeedVR2 模型，4倍超分辨率

### 🎨 主题定制
- **动态主题色**: 360° 色相环，任意颜色
- **背景调节**: 独立的饱和度和亮度控制
- **6 个预设**: 紫、红、绿、蓝、金、粉
- **实时预览**: 所有调整立即生效

### 💾 数据持久化
- **自动保存**: 所有设置和提示词自动保存
- **即时恢复**: 重新打开应用自动恢复状态
- **无需登录**: 使用浏览器本地存储

### ⚙️ 高级设置
- **批次数量**: 1/2/4/8/16 张
- **采样步数**: 8-16 步可调
- **图像比例**: 正方形/竖屏/横屏
- **种子控制**: 随机/固定/首次固定
- **种子拖拽**: 图片拖拽复制种子

---

## 📦 快速开始

### 前置要求

- **Node.js** 16+
- **ComfyUI** 运行在 `http://127.0.0.1:8188`

### 安装

```bash
# 1. 克隆或下载项目
cd CorineGen

# 2. 安装依赖
npm install

# 3. 启动开发服务器
npm run dev

# 4. 浏览器访问
# 默认地址: http://localhost:3000
```

### 构建生产版本

```bash
npm run build
# 输出目录: dist/
```

---

## 📖 使用指南

### 基础操作

1. **添加提示词**
   - 点击右上角 `+` 按钮添加新提示词
   - 每个提示词独立生成图像
   - 支持多行文本输入

2. **生成图像**
   - 单个生成: 点击提示词右下角 `→` 按钮
   - 批量生成: 点击"全部生成"按钮
   - 队列管理: 在 Queue 状态时可点击 `×` 取消

3. **高清化**
   - 等待图片生成完成
   - 点击图片右下角 `HQ` 按钮
   - 支持队列，点击 `Cancel HQ` 取消

4. **下载图像**
   - 点击生成完成的图像即可下载
   - 文件名自动包含参数信息

### 高级技巧

#### 种子复制
拖拽已生成的图片到种子输入框，自动填充种子值，可以精确复现图像。

#### 主题定制
1. 点击右上角 🎨 按钮
2. 调整三个滑块：
   - **主题色相**: 改变整体色调
   - **背景饱和度**: 控制背景鲜艳度
   - **背景亮度**: 控制背景明暗
3. 或点击预设颜色快速切换

#### 批次设置
- **批次模式**: 一次性生成，速度快
- **循环模式**: 逐张生成，可单独取消（推荐）

---

## 🛠️ 技术栈

- **前端框架**: React 18
- **构建工具**: Vite 5.4.21
- **后端 API**: ComfyUI WebSocket + REST
- **存储方案**: localStorage
- **样式方案**: CSS + CSS Variables

---

## 📁 项目结构

```
CorineGen/
├── src/
│   ├── App.jsx           # 主应用组件
│   ├── App.css           # 主样式文件
│   └── main.jsx          # 入口文件
├── CorineGen.json        # 图像生成工作流
├── ImageUpscaleAPI.json  # 高清化工作流
├── README.md             # 用户文档（本文件）
├── DEVELOPMENT.md        # 开发文档
└── package.json          # 项目配置
```

---

## ⚙️ 配置说明

### ComfyUI 地址配置

如果 ComfyUI 运行在不同地址，修改 `src/App.jsx`:

```javascript
const COMFYUI_API = 'http://127.0.0.1:8188'  // 修改此行
const COMFYUI_WS = 'ws://127.0.0.1:8188/ws'  // 修改此行
```

### 模型文件要求

**图像生成**: 需要 CorineGen 工作流兼容的模型

**高清化功能**: 需要以下模型
- `ema_vae_fp16.safetensors`
- `seedvr2_ema_3b_fp16.safetensors`

---

## 🐛 常见问题

### Q: 图片生成失败？

**检查项**:
1. ComfyUI 是否正在运行？
2. 工作流文件是否存在？
3. 浏览器控制台是否有错误？

### Q: 高清化失败？

**可能原因**:
1. 模型文件未下载
2. GPU 内存不足
3. ComfyUI 配置错误

**解决方法**: 查看 ComfyUI 终端日志

### Q: 设置没有保存？

**可能原因**:
1. 浏览器隐私模式
2. localStorage 被禁用

**解决方法**: 使用普通浏览模式，检查浏览器设置

---

## 📊 性能建议

- **推荐浏览器**: Chrome/Edge (最新版)
- **生成图片**: < 20 张时性能最佳
- **批次大小**: 建议 ≤ 4
- **采样步数**: 9-12 步为最佳平衡

---

## 🔄 更新日志

### v1.0.0 (2026-01-04)

**新功能**
- ✨ 多提示词管理系统
- ✨ 生成队列和取消功能
- ✨ 高清化队列系统
- ✨ 动态主题定制（色相/饱和度/亮度）
- ✨ 数据持久化（localStorage）
- ✨ 种子拖拽复制
- ✨ 实时进度反馈和动画

**优化**
- 🚀 使用 ref 避免闭包陷阱
- 🚀 队列系统防止竞态条件
- 🎨 进度文字显式居中定位
- 🎨 移除图片悬停 tooltip

---

## 📝 开发文档

详细的开发文档请查看 [DEVELOPMENT.md](./DEVELOPMENT.md)，包含：

- 完整功能列表和实现细节
- 技术架构和状态管理
- 关键问题与解决方案
- 代码规范和最佳实践
- 性能优化建议
- 未来功能规划

---

## 📄 许可证

MIT License

---

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

提交前请阅读 [DEVELOPMENT.md](./DEVELOPMENT.md) 中的贡献指南。

---

## 📧 联系方式

项目路径: `C:\Users\billy\Desktop\CorineGen`

---

<div align="center">

**Made with ❤️ using React + ComfyUI**

⭐ 如果觉得有用，请给个 Star！

</div>
